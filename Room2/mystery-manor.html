//inspect door at phase three

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Mystery Manor: The Parlor</title>
  <!-- Inline CSS for a luxury castle horror theme -->
  <style>
    /* Import a classic serif font for a regal feel */
    @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap');

    body {
      font-family: 'Cinzel', serif;
      background: linear-gradient(180deg, #1c1c1c, #000000);
      color: #f0e6d2;
      margin: 0;
      padding: 0;
    }

    header {
      background: #4b0000;
      padding: 1.5rem;
      text-align: center;
      color: #f0e6d2;
      border-bottom: 2px solid #d4af37;
    }

    #room-description {
      padding: 1rem 2rem;
      max-width: 800px;
      margin: 1rem auto;
      background: #3a1f1f;
      border: 2px solid #d4af37;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.7);
    }
    
    /* Hint for Phase 4 hidden in room description (digit 5) */
    #room-description p::after {
      content: " (Hint: The ancient oak door bears five mysterious sigils.)";
      font-size: 0.9em;
      color: #d4af37;
      display: block;
      margin-top: 0.5em;
    }

    #puzzle-panel {
      background: #2a2a2a;
      margin: 2rem auto;
      padding: 1rem 2rem;
      max-width: 600px;
      border: 2px solid #d4af37;
      border-radius: 8px;
      text-align: center;
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.8);
    }

    #puzzle-panel h2 {
      margin-top: 0;
      color: #d4af37;
      text-shadow: 1px 1px 2px #000;
    }

    /* Warning message styling */
    #warningMessage {
      margin-bottom: 1rem;
      padding: 0.5rem;
      background: #5d0014;
      border: 1px solid #d4af37;
      border-radius: 4px;
    }

    .warning-text {
      color: #f8d800;
      font-weight: bold;
      text-shadow: 1px 1px 2px #000;
    }

    #display {
      background: linear-gradient(145deg, #3b3b3b, #2a2a2a);
      padding: 1rem;
      border-radius: 6px;
      margin-bottom: 1rem;
      border: 1px solid #d4af37;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
    }

    #display p {
      margin: 0.5rem 0;
    }

    /* Controller-style button panels */
    #buttons, #keypad-buttons {
      margin: 1rem 0;
    }

    #buttons button,
    #keypad-buttons button {
      margin: 0.5rem;
      padding: 0.8rem 1.2rem;
      font-size: 1.1rem;
      cursor: pointer;
      border: 1px solid #d4af37;
      border-radius: 8px;
      background: linear-gradient(145deg, #555, #333);
      color: #f0e6d2;
      text-shadow: 1px 1px 2px #000;
      box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.6);
      transition: all 0.3s ease;
    }

    #buttons button:hover,
    #keypad-buttons button:hover {
      background: linear-gradient(145deg, #333, #555);
      transform: translateY(-2px);
    }

    #buttons button:active,
    #keypad-buttons button:active {
      box-shadow: inset 2px 2px 4px rgba(0, 0, 0, 0.7);
      transform: translateY(0);
    }

    /* Style for dial controls */
    #dials {
      margin: 1rem 0;
      display: flex;
      justify-content: space-around;
      align-items: center;
    }

    #dials label {
      margin-right: 0.5rem;
    }

    /* Custom styling for range inputs (dials) */
    input[type="range"] {
      -webkit-appearance: none;
      width: 120px;
      height: 8px;
      background: #444;
      border-radius: 5px;
      outline: none;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.7);
      margin: 0 0.5rem;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      background: #d4af37;
      border: 1px solid #a67c00;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
    }

    input[type="range"]::-moz-range-thumb {
      width: 20px;
      height: 20px;
      background: #d4af37;
      border: 1px solid #a67c00;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
    }

    /* Submit button styling */
    #submitPuzzle {
      margin-top: 1rem;
      padding: 0.8rem 1.5rem;
      font-size: 1.1rem;
      cursor: pointer;
      border: 1px solid #d4af37;
      border-radius: 8px;
      background: linear-gradient(145deg, #555, #333);
      color: #f0e6d2;
      text-shadow: 1px 1px 2px #000;
      box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.6);
      transition: all 0.3s ease;
    }

    #submitPuzzle:hover {
      background: linear-gradient(145deg, #333, #555);
      transform: translateY(-2px);
    }

    #submitPuzzle:active {
      box-shadow: inset 2px 2px 4px rgba(0, 0, 0, 0.7);
      transform: translateY(0);
    }

    /* Keypad section styling */
    #keypad-section {
      display: none;
      margin: 1rem 0;
      padding: 1rem;
      background: #2a2a2a;
      border: 2px solid #d4af37;
      border-radius: 8px;
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.8);
    }

    #keypad-display {
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }
  </style>
</head>
<body>
  <header>
    <h1>The Parlor Room</h1>
    <p>You step into a dusty, dimly lit parlor. A grand painting, an antique clock, and a mysterious control panel beckon you to uncover their secrets.</p>
  </header>

  <!-- Room description with a hidden hint for digit 5 -->
  <section id="room-description">
    <p>The centerpiece is a control panel mounted on an ornate wooden cabinet. Behind its veneer lie devices and inscriptions whose meanings have been long forgotten. A faded inscription warns: "Never dare to invoke the forbidden code: BAAD."</p>
  </section>

  <!-- Puzzle Panel -->
  <section id="puzzle-panel">
    <h2>The Control Panel</h2>
    <!-- Warning message -->
    <div id="warningMessage">
      <p class="warning-text">Ancient Warning: Never enter the forbidden code <strong>BAAD</strong> â€“ its echo brings only ruin.</p>
    </div>
    
    <!-- Display area with phase-specific intros and hints -->
    <div id="display">
      <!-- Phase 1 introduction: hinting at the digit 3 (thrice, like a bell) -->
      <p id="clueText">As the great castle bell tolls THRICE at twilight, press the correct button sequence to awaken the hidden dials.</p>
      <p id="puzzleFeedback"></p>
    </div>
    
    <!-- Phase 1: Button Sequence -->
    <div id="buttons">
      <button data-value="A">A</button>
      <button data-value="B">B</button>
      <button data-value="C">C</button>
      <button data-value="D">D</button>
    </div>
    
    <!-- Phase 2: Dial Adjustment (initially hidden) -->
    <div id="dial-section" style="display: none;">
      <!-- Phase 2 intro: hinting at the digit 1 (a solitary beacon) -->
      <p>In the dim light, a SOLITARY beacon shines. Adjust the dials until their positions reflect the secret of the night.</p>
      <div id="dials">
        <label for="dial1">Dial 1:</label>
        <input type="range" id="dial1" min="0" max="9" value="0">
        <label for="dial2">Dial 2:</label>
        <input type="range" id="dial2" min="0" max="9" value="0">
      </div>
    </div>
    
    <!-- Phase 3: Keypad Puzzle (initially hidden) -->
    <div id="keypad-section">
      <!-- Phase 3 intro: hinting at the digit 4 (four silent arches) -->
      <p>In the quiet gloom of this ancient manor, every detail holds a secret. Recall the tolling of the great bell at dusk, the solitary light burning in a lonely window, the four silent arches that frame the grand hall, and the subtle markings upon the venerable oak door. In their quiet harmony lies the key to unlocking the final passage. Enter the sacred numeric code.</p>
      <div id="keypad-display">Current Code: </div>
      <div id="keypad-buttons">
        <button data-digit="0">0</button>
        <button data-digit="1">1</button>
        <button data-digit="2">2</button>
        <button data-digit="3">3</button>
        <button data-digit="4">4</button>
        <button data-digit="5">5</button>
        <button data-digit="6">6</button>
        <button data-digit="7">7</button>
        <button data-digit="8">8</button>
        <button data-digit="9">9</button>
        <button id="keypad-clear">Clear</button>
      </div>
    </div>
    
    <!-- Submit button used across all phases -->
    <button id="submitPuzzle">Submit</button>
  </section>

  <!-- Inline JavaScript for puzzle logic -->
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      // Elements for Phases 1 & 2
      const buttons = document.querySelectorAll("#buttons button");
      const feedback = document.getElementById("puzzleFeedback");
      const submitBtn = document.getElementById("submitPuzzle");
      const dialSection = document.getElementById("dial-section");
      const dial1 = document.getElementById("dial1");
      const dial2 = document.getElementById("dial2");

      // Elements for Phase 3 (keypad)
      const keypadSection = document.getElementById("keypad-section");
      const keypadDisplay = document.getElementById("keypad-display");
      const keypadButtons = document.querySelectorAll("#keypad-buttons button[data-digit]");
      const keypadClear = document.getElementById("keypad-clear");

      // Track puzzle phases: 1 = button sequence, 2 = dial adjustment, 3 = keypad entry
      let phase = 1;
      let sequenceInput = "";
      let keypadInput = "";
      const correctSequence = "BADC";    // Phase 1 correct sequence
      const forbiddenPattern = "BAAD";    // Forbidden code
      const correctDial1 = 3;              // Phase 2 dial values
      const correctDial2 = 7;
      const correctKeypad = "3145";        // Phase 3 correct numeric code

      // Utility: count matching characters in sequence
      function countSequenceMatches(input, correct) {
        let matches = 0;
        for (let i = 0; i < Math.min(input.length, correct.length); i++) {
          if (input[i] === correct[i]) matches++;
        }
        return matches;
      }

      // Utility: themed hint for button sequence (Phase 1)
      function getSequenceHint(input) {
        const matches = countSequenceMatches(input, correctSequence);
        if (matches === 0) return "The symbols remain a jumbled enigma.";
        if (matches < correctSequence.length) return `You have ${matches} symbol(s) resonating with the hidden code.`;
        return "";
      }

      // Utility: themed feedback for dial values (Phase 2)
      function getDialFeedback(current, correct, dialName) {
        const diff = Math.abs(current - correct);
        if (diff === 0) return `The ${dialName} aligns perfectly.`;
        if (diff === 1) return `The ${dialName} shimmers almost in harmony.`;
        if (current < correct) return `The ${dialName} seems too low, yearning to rise.`;
        return `The ${dialName} is set too high, lost in the void.`;
      }

      // Phase 1: Button clicks (active only in Phase 1)
      buttons.forEach(button => {
        button.addEventListener("click", function() {
          if (phase === 1) {
            const value = button.getAttribute("data-value");
            sequenceInput += value;
            feedback.textContent = "Current Sequence: " + sequenceInput;
          }
        });
      });

      // Phase 3: Keypad button clicks
      keypadButtons.forEach(btn => {
        btn.addEventListener("click", function() {
          if (phase === 3) {
            const digit = btn.getAttribute("data-digit");
            keypadInput += digit;
            keypadDisplay.textContent = "Current Code: " + keypadInput;
          }
        });
      });
      keypadClear.addEventListener("click", function() {
        if (phase === 3) {
          keypadInput = "";
          keypadDisplay.textContent = "Current Code: ";
        }
      });

      // Submit button (handles actions for all phases)
      submitBtn.addEventListener("click", function() {
        if (phase === 1) {
          // Phase 1: Process button sequence
          if (sequenceInput === forbiddenPattern) {
            feedback.textContent = "A chilling wind howls... You have invoked the forbidden sequence 'BAAD'. The manor condemns you to DEATH! Restarting...";
            setTimeout(() => window.location.reload(), 3000);
            return;
          }
          if (sequenceInput === correctSequence) {
            feedback.textContent = "The hidden symbols resonate... The control panel reveals the secret dials!";
            dialSection.style.display = "block";
            document.getElementById("buttons").style.display = "none";
            phase = 2;
            sequenceInput = "";
            // Update clue text for Phase 2 (hinting at digit 1)
            document.getElementById("clueText").textContent = "A SOLITARY beacon in the gloom beckons. Adjust the dials to their proper positions.";
          } else {
            const hint = getSequenceHint(sequenceInput);
            feedback.textContent = `The panel murmurs: "${hint}" Try again.`;
            sequenceInput = "";
          }
        } else if (phase === 2) {
          // Phase 2: Process dial values
          const currentDial1 = parseInt(dial1.value, 10);
          const currentDial2 = parseInt(dial2.value, 10);
          if (currentDial1 === correctDial1 && currentDial2 === correctDial2) {
            feedback.textContent = "The mechanisms click... A hidden compartment opens, revealing a numeric keypad!";
            dialSection.style.display = "none";
            keypadSection.style.display = "block";
            phase = 3;
            // Update clue text for Phase 3 with the cryptic passage
            keypadInput = "";
            keypadDisplay.textContent = "Current Code: ";
          } else {
            const dial1Feedback = getDialFeedback(currentDial1, correctDial1, "first dial");
            const dial2Feedback = getDialFeedback(currentDial2, correctDial2, "second dial");
            feedback.textContent = `The dials whisper: "${dial1Feedback} ${dial2Feedback}" Adjust them carefully.`;
          }
        } else if (phase === 3) {
          // Phase 3: Process keypad input
          if (keypadInput === correctKeypad) {
            feedback.textContent = "The final mechanism hums with ancient power. The secret door slowly opens, revealing mysteries beyond...";
          } else {
            feedback.textContent = `The keypad remains unyielding. The code "${keypadInput}" is not correct. Try again.`;
            keypadInput = "";
            keypadDisplay.textContent = "Current Code: ";
          }
        }
      });
    });
  </script>
</body>
</html>
